# suppress inspection "SpringBootApplicationProperties" for whole file
# H2 Test Datasource
spring.datasource.url=jdbc:h2:mem:testdb
spring.datasource.driverClassName=org.h2.Driver
spring.datasource.username=root
spring.datasource.password=password123
spring.sql.init.mode=always
spring.jpa.database-platform=org.hibernate.dialect.H2Dialect
spring.h2.console.enabled=true
spring.jpa.hibernate.ddl-auto=update
spring.jpa.show-sql=true
server.servlet.encoding.charset=UTF-8

# SQL scripts
sql.script.create.table.person=CREATE TABLE IF NOT EXISTS Person \
  (id INT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,\
  full_name VARCHAR(100) NOT NULL,\
  email VARCHAR(100) UNIQUE NOT NULL,\
  birth_year INT NOT NULL CHECK (birth_year > 1900 AND birth_year <= YEAR(CURRENT_TIMESTAMP)))

sql.script.create.table.book=CREATE TABLE IF NOT EXISTS Book \
  (id INT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,\
  person_id INT REFERENCES Person(id) ON DELETE SET NULL,\
  title VARCHAR(100) NOT NULL,\
  author VARCHAR(100) NOT NULL,\
  book_year INT NOT NULL CHECK (book_year > 1400 AND book_year <= YEAR(CURRENT_TIMESTAMP)),\
  taken_at TIMESTAMP)

sql.script.add.people=INSERT INTO Person (full_name, birth_year, email) \
  VALUES ('Test Name1', 1970, 'cv@gmail.com'),\
         ('Test Name2', 2003, 'jane@gmail.com'),\
         ('Test Name3', 1999, 'test@ukr.net')

sql.script.add.books=INSERT INTO Book (person_id, title, author, book_year, taken_at) \
  VALUES (null, 'Test Title1', 'Ivan Bagryany', 1946, null),\
         (1, 'Test Title2', 'Taras Shevchenko', 1840, '2025-01-01 10:00:00')

sql.script.drop.table.book=DROP TABLE IF EXISTS Book
sql.script.drop.table.person=DROP TABLE IF EXISTS Person
